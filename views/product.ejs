<div
  x-data="productPage()"
  class="grid grid-cols-1 md:grid-cols-2 gap-8 md:gap-12 items-start mt-8"
>
  <!-- الصور -->
  <div class="flex flex-col">
    <div
      class="bg-base-100 rounded-xl shadow-lg overflow-hidden mb-4 border border-neutral-200"
    >
      <img
        :src="mainImage"
        alt="Door preview"
        class="w-full h-auto object-cover aspect-3/4 transition-all duration-500 ease-in-out"
      />
    </div>

    <div class="grid grid-cols-4 sm:grid-cols-5 gap-2 xs:gap-3">
      <template x-for="(image, i) in galleryImages" :key="i">
        <div
          @click="mainImage = image"
          :class="mainImage === image
            ? 'ring-2 ring-primary ring-offset-2'
            : 'ring-1 ring-transparent hover:ring-neutral-400'"
          class="rounded-lg overflow-hidden cursor-pointer transition-all duration-200"
        >
          <img
            :src="image"
            class="w-full h-20 xs:h-24 object-cover"
            alt="Door thumbnail"
          />
        </div>
      </template>
    </div>
  </div>

  <!-- التفاصيل -->
  <div class="flex flex-col justify-center py-4">
    <h1 class="text-3xl md:text-4xl font-bold mb-3 text-neutral-800">
      <%= product.name %>
    </h1>

    <p class="text-base text-neutral-400 mb-6 leading-relaxed">
      <%= product.description %>
    </p>

    <!-- اختيار اللون -->
    <div class="mb-8">
      <label class="text-sm font-semibold text-neutral-800 mb-2 block"
        >Available colors</label
      >
      <div class="flex flex-wrap items-center gap-3">
        <% for (let color of product.colors) { %>
        <button
          @click="changeColor('<%= color.hex %>', <%- JSON.stringify(color.images || []) %>)"
          class="btn btn-circle btn-md border-2 border-neutral-300 transition-transform hover:scale-105"
          style="background-color: <%= color.hex %>"
          aria-label="<%= color.name %>"
        ></button>
        <% } %>
      </div>
    </div>

    <!-- الأزرار -->
    <div class="flex flex-col sm:flex-row gap-3 sm:gap-4">
      <button class="btn btn-neutral btn-lg w-full sm:w-auto text-lg">
        <i class="fa-solid fa-phone"></i> Call Us
      </button>
      <button class="btn btn-outline btn-lg w-full sm:w-auto text-lg">
        <i class="fa-brands fa-whatsapp"></i> WhatsApp
      </button>
      <button class="btn btn-outline btn-lg w-full sm:w-auto text-lg">
        <i class="fa-solid fa-envelope"></i> Email
      </button>
    </div>
  </div>
</div>

<script>
  function productPage() {
    return {
      mainImage:
        "<%= product.images && product.images.length ? product.images[0] : '' %>",
      galleryImages: <%- JSON.stringify(product.images || []) %>,
      changeColor(hex, images) {
        this.galleryImages = images.length ? images : <%- JSON.stringify(product.images || []) %>;
        this.mainImage = this.galleryImages[0];
      },
    };
  }
</script>
